before_install:
- git submodule update --init --recursive
language: ruby
rvm:
- 1.9.3
env:
  global:
  - DB=mysql
  - secure: "jsFhL3SkB6ocCVJvJ4NU133VjN2MYALKrvhZXvijZ5qFWWXENDx9oeBXutdTLae/NWuTkNx+5wAGfjF+Bx2wOUjgh+AB0/UbZkRD9JJ+te4hzb3fD4DjTLIz1rC6wwkzt6QlgXJUKTREmjhtfKUYvm1bFambs4cfanD31Lplo1w=" # SAUCE_URL
  - TRAVIS_LAUNCHES_SAUCE_CONNECT=true # Tell the karma file that it does not need to launch Sauce connect
  - RAILS_ENV=development #default to the development server for Selenium tests
script:
- RAILS_ENV=test bundle exec rake --trace db:migrate test
- cd public/apps # Run the selenium tests
- "bundle exec ruby test/selenium/run_all.rb -p sauce_firefox_web -c http://localhost:3000"
- "bundle exec ruby test/selenium/run_all.rb -p sauce_chrome_web -c http://localhost:3000"
before_script:
- cp config/database.travis.yml config/database.yml
- mysql -e 'create database privly_test'
- mysql -e 'create database privly_development'
- bundle exec rake db:create #Creates the Database
- bundle exec rake db:schema:load #Loads the Scheme
- bundle exec rake db:seed #Seeds the DB
- "bundle exec rails server -p 3000 &" # Start the server for Selenium testing
addons:
  sauce_connect:
    username: privly
    access_key:
      secure: "BZ14Zfi882UuwJmXZg9gMTb9WpydC6tt7cbfUMSAOP5UBvc2hvI34VIbpzYtjHGlJVN/rCMOa3Rc8ndPMo8zBQFGt97Kv1vT/OkvYA9u0RWQh7Gr0T11KJPE4DrQc7eTsTToQ6uHDIpgCdDnZBsKELCsckRKKKgz2/v4CQMow24="
